run_name: bert-embeddings-pile-nobooks
platform: r1z1
gpu_type: a100_80gb
gpu_num: 8
image: growlix/data-dedupe
command: |
  cd streaming

  git pull

  cd scripts/deduplication/approximate
   
  pip install --upgrade requests

  python get_embeddings.py --batch_size_dataloader 512 --batch_size_inference 1024 --streaming_remote s3://mosaicml-internal-checkpoints-shared/matthew/nobookscorpus --file_name EMB_MEMORY.npy

  aws s3 cp EMB_MEMORY.npy s3://mosaicml-internal-checkpoints-shared/matthew/embeddings/pilenobookscorpus_train_e5base_embeddings.npy
